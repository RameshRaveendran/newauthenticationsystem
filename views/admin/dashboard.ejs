<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="/css/admin-dashboard.css" />
</head>

<body>
  <div class="admin-layout">

    <!-- Top Bar -->
    <header class="topbar">
      <div class="topbar-left">
        <h1 class="logo">Admin Panel</h1>
      </div>
      <div class="topbar-right">
        <button id="logoutBtn" class="btn btn-outline">Logout</button>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">

      <!-- Welcome + Stats -->
      <section class="welcome-section">
        <div class="welcome-card">
          <h1>Welcome, <%= user.name %></h1>

          <ul>
            <li><strong>Email:</strong> <%= user.email %></li>
            <li><strong>Role:</strong> <%= user.role %></li>
          </ul>

          <p>
            Manage your users, update their details, and keep your app secure.
          </p>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <h3>Total Users</h3>
            <p id="totalUsers">0</p>
          </div>
          <div class="stat-card">
            <h3>Active Sessions</h3>
            <p>5</p>
          </div>
          <div class="stat-card">
            <h3>Admins</h3>
            <p>1</p>
          </div>
        </div>
      </section>

      <!-- Users & Edit Panel -->
      <section class="users-section">

        <!-- Users Table -->
        <div class="users-table-card">
          <div class="card-header">
            <h2>Users</h2>
          </div>

          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>#</th>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Role</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="usersTableBody">
                <!-- Filled by JS -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- Edit User Form -->
        <div class="edit-user-card">
          <div class="card-header">
            <h2>Edit User</h2>
          </div>

          <form id="editUserForm" class="form">

            <!-- Hidden ID -->
            <input type="hidden" id="editUserId" />

            <div class="form-group">
              <label for="editUserName">Name</label>
              <input type="text" id="editUserName" disabled />
            </div>

            <div class="form-group">
              <label for="editUserEmail">Email</label>
              <input
                type="email"
                id="editUserEmail"
                placeholder="Enter new email"
                required
              />
            </div>

            <div class="form-group">
              <label for="editUserPassword">New Password</label>
              <input
                type="password"
                id="editUserPassword"
                placeholder="Leave blank to keep current password"
              />
            </div>

            <!-- âœ… ROLE SELECT (FIXED POSITION) -->
            <div class="form-group">
              <label for="editUserRole">Role</label>
              <select id="editUserRole">
                <option value="user">User</option>
                <option value="admin">Admin</option>
              </select>
            </div>

            <button type="submit" class="btn btn-primary full-width">
              Update User
            </button>

            <p class="hint-text">
              This will update user's email, password, and role securely.
            </p>

          </form>
        </div>
      </section>
    </main>
  </div>

  <script src="/js/admin-dashboard.js" defer></script>

  <!-- Prevent back button cache issue -->
  <script>
    window.addEventListener("pageshow", function (event) {
      if (event.persisted) {
        window.location.reload();
      }
    });
  </script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>

</html>
